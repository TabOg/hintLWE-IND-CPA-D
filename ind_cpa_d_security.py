# this code corresponds to section 6.2
from sage.all import log, pi, sqrt
from hintLWE_security import hint_lwe_decision_normalised_noise_flooding

# this is the required flooding noise from the prior art as a function of a total noise bound E, number of decryptions, and a target security level
def prior_flooding_noise(t, logE, target_security):
    total_flooding_noise = logE + target_security / 2 + 0.5 * log(64 * t, 2)
    return total_flooding_noise

# this is the required flooding noise from our Theorem 3
def bit_security_flooding_noise(logE, target_security):
    total_flooding_noise = logE + target_security / 2 + 0.5 * log(4, 2)
    return total_flooding_noise

# our flooding noise is linear in |[A]_q/q|_2, or in the ring setting, |[a]_q / q|^can_2. We take a worst case bound on this value
def worst_case_ATA(n):
    return (2 * n / pi) ** 2 + 1

# this is the amount of required noise to use a HintLWE reduction when the original secret width is sigma, the secret width after hints in sigma_prime.
# t: the number of allowed decryptions
# ATA_bound: a bound on the hint matrix |[A]_q / q|_2^2  
def sigma_i(t, ATA_bound, log_normalised_flooding_stddev):
    sigma_i_ = 0.5 * log(t, 2) + 0.5 * log(ATA_bound, 2) + log_normalised_flooding_stddev
    return sigma_i_

def hint_lwe_flooding_noise(t, rescaled_noise_bound, target_security, n, log_normalised_flooding_stddev):
    ATA_bound = worst_case_ATA(n)
    sigma_i_ = sigma_i(t, ATA_bound, log_normalised_flooding_stddev)
    rescaled_noise_flooding = bit_security_flooding_noise(rescaled_noise_bound, target_security)
    return max(rescaled_noise_flooding, sigma_i_)

def flooding_noise_levels(parameters, t, original_security, target_security, max_rescaled_noise_magnitude=40):
    (logn, logq, sigma_s, sigma_e) = parameters
    n = 2 ** logn
    
    absolute_noise = {"prior": [], "bit_security": [], "hint_lwe": []}
    
    additional_noise = {"prior": [], "bit_security": [], "hint_lwe": []}
    
    # a (2 norm) bound on the noise due to rescaling, ([A]_q * s - [b]_q ) / q
    rescaling_noise = (sqrt(worst_case_ATA(n)) * sqrt(n) * sigma_s + 0.5).n()
    
    cross_over_point = log(rescaling_noise, 2).n()
    
    # this is the security we target for HintLWE (Decision)
    kappa_prime = target_security + 4 + log(12, 2).n()
    try:
        [(_, log_normalised_flooding_stddev)] = hint_lwe_decision_normalised_noise_flooding([parameters], kappa_prime)
    except:
        ValueError(f"cannot achieve {target_security=} via reduction: try increasing secret variance or decreasing target security")
        return cross_over_point, absolute_noise, additional_noise
        
    # since our results are in terms of |error|_2, we convert this to addition precision loss via sqrt(n) * sigma / |error|_2
    additional_precision_loss = lambda logn, log_sigma, log_total_noise: (logn / 2 + log_sigma - log_total_noise).n()
    
    for rescaled_noise_magnitude in range(1, max_rescaled_noise_magnitude + 1):
        # first we calculate a bound on the total noise from the bound on the rescaled noise magnitude
        total_noise = 2 ** rescaled_noise_magnitude + rescaling_noise
        log_total_noise = log(total_noise, 2)
        
        # prior result requires gap between IND-CPA and IND-CPA-D security at least 8
        if original_security - target_security >= 8:            
            prior_flooding_noise_ = prior_flooding_noise(t, log_total_noise, target_security)
            absolute_noise["prior"].append((rescaled_noise_magnitude, prior_flooding_noise_.n()))
            prior_precision_loss = additional_precision_loss(logn, prior_flooding_noise_, log_total_noise)
            additional_noise["prior"].append((rescaled_noise_magnitude, prior_precision_loss))
        
        # our bit security result requires a gap between IND-CPA and IND-CPA-D security at least 4
        if original_security - target_security >= 4:
            bit_security_flooding_noise_ = bit_security_flooding_noise(log_total_noise, target_security)
            absolute_noise["bit_security"].append((rescaled_noise_magnitude, bit_security_flooding_noise_.n()))
            bit_security_precision_loss = additional_precision_loss(logn, bit_security_flooding_noise_, log_total_noise)
            additional_noise["bit_security"].append((rescaled_noise_magnitude, bit_security_precision_loss))

        hint_lwe_flooding_noise_ = hint_lwe_flooding_noise(t, rescaled_noise_magnitude, target_security, n, log_normalised_flooding_stddev)
        absolute_noise["hint_lwe"].append((rescaled_noise_magnitude, hint_lwe_flooding_noise_))
        hint_lwe_precision_loss = additional_precision_loss(logn, hint_lwe_flooding_noise_, log_total_noise)
        additional_noise["hint_lwe"].append((rescaled_noise_magnitude, hint_lwe_precision_loss))
        
    return cross_over_point, absolute_noise, additional_noise
    
if __name__ == "__main__":
    # this script generates the data for Fig 3
    target_security = 80
    t = 2 ** 6
    
    parameter_sets = [
        (10, 28, 3.19, 3.19),
        (12, 108, 3.19, 3.19),
        (14, 432, 3.19, 3.19),
        (16, 1749, 3.19, 3.19)
        ]
    original_security_levels = [
        131.903812370381,
        128.934036200343,
        128.334392294043,
        128.021734664213
    ]
    
    for parameters, original_security in zip(parameter_sets, original_security_levels):
        print(f"# {parameters=}")
        cross_over_point, absolute_noise, additional_noise = flooding_noise_levels(parameters, t, original_security, target_security)
        print(f"# cross over point (rescaling noise = rescaled noise) at {cross_over_point}")
        
        print("# absolute noise:")
        for key in absolute_noise.keys():
            print(f"#\t{key}:", absolute_noise[key])
            print()
        print()
        print("# additional noise:")
        for key in additional_noise.keys():
            print(f"#\t{key}:", additional_noise[key])
            print()
        print()
        print()
    
## output:

# parameters=(12, 108, 3.19, 3.19)
# cross over point (rescaling noise = rescaled noise) at 19.0220617555875
# absolute noise:
#       prior: [(1, 65.0220671755035), (2, 65.0220725953991), (3, 65.0220834351291), (4, 65.0221051143450), (5, 65.0221484717993), (6, 65.0222351827991), (7, 65.0224085891655), (8, 65.0227553393823), (9, 65.0234485898930), (10, 65.0248340923421), (11, 65.0276011118868), (12, 65.0331192806588), (13, 65.0440926996359), (14, 65.0657922700001), (15, 65.1082361435706), (16, 65.1895520451485), (17, 65.3396044063807), (18, 65.5997077593262), (19, 66.0110730485492), (20, 66.5923539681789), (21, 67.3263675181165), (22, 68.1723930340158), (23, 69.0887699726475), (24, 70.0450676379792), (25, 71.0227097925457), (26, 72.0113995808162), (27, 73.0057110497267), (28, 74.0028583508303), (29, 75.0014298833063), (30, 76.0007151188013), (31, 77.0003576037096), (32, 78.0001788129348), (33, 79.0000894092377), (34, 80.0000447053115), (35, 81.0000223528289), (36, 82.0000111764577), (37, 83.0000055882397), (38, 84.0000027941226), (39, 85.0000013970620), (40, 86.0000006985312)]

#       bit_security: [(1, 60.0220671755035), (2, 60.0220725953991), (3, 60.0220834351291), (4, 60.0221051143450), (5, 60.0221484717993), (6, 60.0222351827991), (7, 60.0224085891655), (8, 60.0227553393823), (9, 60.0234485898930), (10, 60.0248340923421), (11, 60.0276011118868), (12, 60.0331192806588), (13, 60.0440926996359), (14, 60.0657922700001), (15, 60.1082361435706), (16, 60.1895520451485), (17, 60.3396044063807), (18, 60.5997077593262), (19, 61.0110730485491), (20, 61.5923539681789), (21, 62.3263675181165), (22, 63.1723930340158), (23, 64.0887699726475), (24, 65.0450676379792), (25, 66.0227097925457), (26, 67.0113995808162), (27, 68.0057110497267), (28, 69.0028583508303), (29, 70.0014298833063), (30, 71.0007151188013), (31, 72.0003576037096), (32, 73.0001788129348), (33, 74.0000894092377), (34, 75.0000447053115), (35, 76.0000223528289), (36, 77.0000111764577), (37, 78.0000055882397), (38, 79.0000027941226), (39, 80.0000013970620), (40, 81.0000006985312)]

#       hint_lwe: [(1, 42.0), (2, 43.0), (3, 44.0), (4, 45.0), (5, 46.0), (6, 47.0), (7, 48.0), (8, 49.0), (9, 50.0), (10, 51.0), (11, 52.0), (12, 53.0), (13, 54.0), (14, 55.0), (15, 56.0), (16, 57.0), (17, 58.0), (18, 59.0), (19, 60.0), (20, 61.0), (21, 62.0), (22, 63.0), (23, 64.0), (24, 65.0), (25, 66.0), (26, 67.0), (27, 68.0), (28, 69.0), (29, 70.0), (30, 71.0), (31, 72.0), (32, 73.0), (33, 74.0), (34, 75.0), (35, 76.0), (36, 77.0), (37, 78.0), (38, 79.0), (39, 80.0), (40, 81.0)]

# additional noise:
#       prior: [(1, 52.0000000000000), (2, 52.0000000000000), (3, 52.0000000000000), (4, 52.0000000000000), (5, 52.0000000000000), (6, 52.0000000000000), (7, 52.0000000000000), (8, 52.0000000000000), (9, 52.0000000000000), (10, 52.0000000000000), (11, 52.0000000000000), (12, 52.0000000000000), (13, 52.0000000000000), (14, 52.0000000000000), (15, 52.0000000000000), (16, 52.0000000000000), (17, 52.0000000000000), (18, 52.0000000000000), (19, 52.0000000000000), (20, 52.0000000000000), (21, 52.0000000000000), (22, 52.0000000000000), (23, 52.0000000000000), (24, 52.0000000000000), (25, 52.0000000000000), (26, 52.0000000000000), (27, 52.0000000000000), (28, 52.0000000000000), (29, 52.0000000000000), (30, 52.0000000000000), (31, 52.0000000000000), (32, 52.0000000000000), (33, 52.0000000000000), (34, 52.0000000000000), (35, 52.0000000000000), (36, 52.0000000000000), (37, 52.0000000000000), (38, 52.0000000000000), (39, 52.0000000000000), (40, 52.0000000000000)]

#       bit_security: [(1, 47.0000000000000), (2, 47.0000000000000), (3, 47.0000000000000), (4, 47.0000000000000), (5, 47.0000000000000), (6, 47.0000000000000), (7, 47.0000000000000), (8, 47.0000000000000), (9, 47.0000000000000), (10, 47.0000000000000), (11, 47.0000000000000), (12, 47.0000000000000), (13, 47.0000000000000), (14, 47.0000000000000), (15, 47.0000000000000), (16, 47.0000000000000), (17, 47.0000000000000), (18, 47.0000000000000), (19, 47.0000000000000), (20, 47.0000000000000), (21, 47.0000000000000), (22, 47.0000000000000), (23, 47.0000000000000), (24, 47.0000000000000), (25, 47.0000000000000), (26, 47.0000000000000), (27, 47.0000000000000), (28, 47.0000000000000), (29, 47.0000000000000), (30, 47.0000000000000), (31, 47.0000000000000), (32, 47.0000000000000), (33, 47.0000000000000), (34, 47.0000000000000), (35, 47.0000000000000), (36, 47.0000000000000), (37, 47.0000000000000), (38, 47.0000000000000), (39, 47.0000000000000), (40, 47.0000000000000)]

#       hint_lwe: [(1, 28.9779328244965), (2, 29.9779274046009), (3, 30.9779165648709), (4, 31.9778948856551), (5, 32.9778515282007), (6, 33.9777648172009), (7, 34.9775914108345), (8, 35.9772446606177), (9, 36.9765514101070), (10, 37.9751659076579), (11, 38.9723988881132), (12, 39.9668807193412), (13, 40.9559073003641), (14, 41.9342077299999), (15, 42.8917638564294), (16, 43.8104479548515), (17, 44.6603955936193), (18, 45.4002922406738), (19, 45.9889269514509), (20, 46.4076460318211), (21, 46.6736324818835), (22, 46.8276069659842), (23, 46.9112300273525), (24, 46.9549323620208), (25, 46.9772902074543), (26, 46.9886004191838), (27, 46.9942889502733), (28, 46.9971416491697), (29, 46.9985701166937), (30, 46.9992848811987), (31, 46.9996423962904), (32, 46.9998211870652), (33, 46.9999105907623), (34, 46.9999552946885), (35, 46.9999776471711), (36, 46.9999888235423), (37, 46.9999944117603), (38, 46.9999972058774), (39, 46.9999986029380), (40, 46.9999993014689)]
        
        
# parameters=(14, 432, 3.19, 3.19)
# cross over point (rescaling noise = rescaled noise) at 22.0220604705212
# absolute noise:
#       prior: [(1, 68.0220611480124), (2, 68.0220618255032), (3, 68.0220631804841), (4, 68.0220658904419), (5, 68.0220713103423), (6, 68.0220821500821), (7, 68.0221038293172), (8, 68.0221471868102), (9, 68.0222338978872), (10, 68.0224073044080), (11, 68.0227540549336), (12, 68.0234473060613), (13, 68.0248328097428), (14, 68.0275998317450), (15, 68.0331180054042), (16, 68.0440914340443), (17, 68.0657910233018), (18, 68.1082349330157), (19, 68.1895509009380), (20, 68.3396033751979), (21, 68.5997068982597), (22, 69.0110724011034), (23, 69.5923535354455), (24, 70.3263672579447), (25, 71.1723928892783), (26, 72.0887698959601), (27, 73.0450675984562), (28, 74.0227097724756), (29, 75.0113995707022), (30, 76.0057110446497), (31, 77.0028583482867), (32, 78.0014298820332), (33, 79.0007151181645), (34, 80.0003576033911), (35, 81.0001788127755), (36, 82.0000894091581), (37, 83.0000447052717), (38, 84.0000223528090), (39, 85.0000111764478), (40, 86.0000055882347)]

#       bit_security: [(1, 63.0220611480124), (2, 63.0220618255033), (3, 63.0220631804841), (4, 63.0220658904419), (5, 63.0220713103423), (6, 63.0220821500821), (7, 63.0221038293172), (8, 63.0221471868102), (9, 63.0222338978872), (10, 63.0224073044080), (11, 63.0227540549336), (12, 63.0234473060613), (13, 63.0248328097428), (14, 63.0275998317450), (15, 63.0331180054042), (16, 63.0440914340443), (17, 63.0657910233018), (18, 63.1082349330157), (19, 63.1895509009380), (20, 63.3396033751979), (21, 63.5997068982596), (22, 64.0110724011034), (23, 64.5923535354455), (24, 65.3263672579447), (25, 66.1723928892783), (26, 67.0887698959601), (27, 68.0450675984562), (28, 69.0227097724756), (29, 70.0113995707022), (30, 71.0057110446497), (31, 72.0028583482867), (32, 73.0014298820332), (33, 74.0007151181645), (34, 75.0003576033911), (35, 76.0001788127755), (36, 77.0000894091581), (37, 78.0000447052717), (38, 79.0000223528090), (39, 80.0000111764478), (40, 81.0000055882347)]

#       hint_lwe: [(1, 42.0), (2, 43.0), (3, 44.0), (4, 45.0), (5, 46.0), (6, 47.0), (7, 48.0), (8, 49.0), (9, 50.0), (10, 51.0), (11, 52.0), (12, 53.0), (13, 54.0), (14, 55.0), (15, 56.0), (16, 57.0), (17, 58.0), (18, 59.0), (19, 60.0), (20, 61.0), (21, 62.0), (22, 63.0), (23, 64.0), (24, 65.0), (25, 66.0), (26, 67.0), (27, 68.0), (28, 69.0), (29, 70.0), (30, 71.0), (31, 72.0), (32, 73.0), (33, 74.0), (34, 75.0), (35, 76.0), (36, 77.0), (37, 78.0), (38, 79.0), (39, 80.0), (40, 81.0)]

# additional noise:
#       prior: [(1, 53.0000000000000), (2, 53.0000000000000), (3, 53.0000000000000), (4, 53.0000000000000), (5, 53.0000000000000), (6, 53.0000000000000), (7, 53.0000000000000), (8, 53.0000000000000), (9, 53.0000000000000), (10, 53.0000000000000), (11, 53.0000000000000), (12, 53.0000000000000), (13, 53.0000000000000), (14, 53.0000000000000), (15, 53.0000000000000), (16, 53.0000000000000), (17, 53.0000000000000), (18, 53.0000000000000), (19, 53.0000000000000), (20, 53.0000000000000), (21, 53.0000000000000), (22, 53.0000000000000), (23, 53.0000000000000), (24, 53.0000000000000), (25, 53.0000000000000), (26, 53.0000000000000), (27, 53.0000000000000), (28, 53.0000000000000), (29, 53.0000000000000), (30, 53.0000000000000), (31, 53.0000000000000), (32, 53.0000000000000), (33, 53.0000000000000), (34, 53.0000000000000), (35, 53.0000000000000), (36, 53.0000000000000), (37, 53.0000000000000), (38, 53.0000000000000), (39, 53.0000000000000), (40, 53.0000000000000)]

#       bit_security: [(1, 48.0000000000000), (2, 48.0000000000000), (3, 48.0000000000000), (4, 48.0000000000000), (5, 48.0000000000000), (6, 48.0000000000000), (7, 48.0000000000000), (8, 48.0000000000000), (9, 48.0000000000000), (10, 48.0000000000000), (11, 48.0000000000000), (12, 48.0000000000000), (13, 48.0000000000000), (14, 48.0000000000000), (15, 48.0000000000000), (16, 48.0000000000000), (17, 48.0000000000000), (18, 48.0000000000000), (19, 48.0000000000000), (20, 48.0000000000000), (21, 48.0000000000000), (22, 48.0000000000000), (23, 48.0000000000000), (24, 48.0000000000000), (25, 48.0000000000000), (26, 48.0000000000000), (27, 48.0000000000000), (28, 48.0000000000000), (29, 48.0000000000000), (30, 48.0000000000000), (31, 48.0000000000000), (32, 48.0000000000000), (33, 48.0000000000000), (34, 48.0000000000000), (35, 48.0000000000000), (36, 48.0000000000000), (37, 48.0000000000000), (38, 48.0000000000000), (39, 48.0000000000000), (40, 48.0000000000000)]

#       hint_lwe: [(1, 26.9779388519876), (2, 27.9779381744967), (3, 28.9779368195159), (4, 29.9779341095581), (5, 30.9779286896577), (6, 31.9779178499179), (7, 32.9778961706828), (8, 33.9778528131898), (9, 34.9777661021128), (10, 35.9775926955920), (11, 36.9772459450664), (12, 37.9765526939387), (13, 38.9751671902572), (14, 39.9724001682550), (15, 40.9668819945958), (16, 41.9559085659557), (17, 42.9342089766982), (18, 43.8917650669843), (19, 44.8104490990620), (20, 45.6603966248021), (21, 46.4002931017404), (22, 46.9889275988966), (23, 47.4076464645545), (24, 47.6736327420553), (25, 47.8276071107217), (26, 47.9112301040399), (27, 47.9549324015438), (28, 47.9772902275244), (29, 47.9886004292978), (30, 47.9942889553503), (31, 47.9971416517133), (32, 47.9985701179668), (33, 47.9992848818355), (34, 47.9996423966089), (35, 47.9998211872245), (36, 47.9999105908419), (37, 47.9999552947283), (38, 47.9999776471910), (39, 47.9999888235522), (40, 47.9999944117653)]


# parameters=(16, 1749, 3.19, 3.19)
# cross over point (rescaling noise = rescaled noise) at 25.0220603161038
# absolute noise:
#       prior: [(1, 71.0220604007903), (2, 71.0220604854767), (3, 71.0220606548495), (4, 71.0220609935951), (5, 71.0220616710861), (6, 71.0220630260671), (7, 71.0220657360252), (8, 71.0220711559262), (9, 71.0220819956671), (10, 71.0221036749045), (11, 71.0221470324021), (12, 71.0222337434885), (13, 71.0224071500278), (14, 71.0227539005905), (15, 71.0234471517923), (16, 71.0248326556219), (17, 71.0275996779195), (18, 71.0331178521659), (19, 71.0440912819672), (20, 71.0657908734949), (21, 71.1082347875519), (22, 71.1895507634464), (23, 71.3396032512879), (24, 71.5997067947914), (25, 72.0110723233044), (26, 72.5923534834471), (27, 73.3263672266817), (28, 74.1723928718862), (29, 75.0887698867451), (30, 76.0450675937070), (31, 77.0227097700639), (32, 78.0113995694868), (33, 79.0057110440396), (34, 80.0028583479811), (35, 81.0014298818803), (36, 82.0007151180879), (37, 83.0003576033529), (38, 84.0001788127564), (39, 85.0000894091485), (40, 86.0000447052669)]

#       bit_security: [(1, 66.0220604007903), (2, 66.0220604854767), (3, 66.0220606548495), (4, 66.0220609935951), (5, 66.0220616710861), (6, 66.0220630260671), (7, 66.0220657360252), (8, 66.0220711559262), (9, 66.0220819956671), (10, 66.0221036749045), (11, 66.0221470324021), (12, 66.0222337434885), (13, 66.0224071500278), (14, 66.0227539005905), (15, 66.0234471517923), (16, 66.0248326556219), (17, 66.0275996779195), (18, 66.0331178521659), (19, 66.0440912819672), (20, 66.0657908734949), (21, 66.1082347875519), (22, 66.1895507634464), (23, 66.3396032512879), (24, 66.5997067947914), (25, 67.0110723233044), (26, 67.5923534834471), (27, 68.3263672266817), (28, 69.1723928718862), (29, 70.0887698867451), (30, 71.0450675937070), (31, 72.0227097700639), (32, 73.0113995694868), (33, 74.0057110440396), (34, 75.0028583479811), (35, 76.0014298818803), (36, 77.0007151180879), (37, 78.0003576033529), (38, 79.0001788127564), (39, 80.0000894091485), (40, 81.0000447052669)]

#       hint_lwe: [(1, 42.0), (2, 43.0), (3, 44.0), (4, 45.0), (5, 46.0), (6, 47.0), (7, 48.0), (8, 49.0), (9, 50.0), (10, 51.0), (11, 52.0), (12, 53.0), (13, 54.0), (14, 55.0), (15, 56.0), (16, 57.0), (17, 58.0), (18, 59.0), (19, 60.0), (20, 61.0), (21, 62.0), (22, 63.0), (23, 64.0), (24, 65.0), (25, 66.0), (26, 67.0), (27, 68.0), (28, 69.0), (29, 70.0), (30, 71.0), (31, 72.0), (32, 73.0), (33, 74.0), (34, 75.0), (35, 76.0), (36, 77.0), (37, 78.0), (38, 79.0), (39, 80.0), (40, 81.0)]


# additional noise
#       prior: [(1, 54.0000000000000), (2, 54.0000000000000), (3, 54.0000000000000), (4, 54.0000000000000), (5, 54.0000000000000), (6, 54.0000000000000), (7, 54.0000000000000), (8, 54.0000000000000), (9, 54.0000000000000), (10, 54.0000000000000), (11, 54.0000000000000), (12, 54.0000000000000), (13, 54.0000000000000), (14, 54.0000000000000), (15, 54.0000000000000), (16, 54.0000000000000), (17, 54.0000000000000), (18, 54.0000000000000), (19, 54.0000000000000), (20, 54.0000000000000), (21, 54.0000000000000), (22, 54.0000000000000), (23, 54.0000000000000), (24, 54.0000000000000), (25, 54.0000000000000), (26, 54.0000000000000), (27, 54.0000000000000), (28, 54.0000000000000), (29, 54.0000000000000), (30, 54.0000000000000), (31, 54.0000000000000), (32, 54.0000000000000), (33, 54.0000000000000), (34, 54.0000000000000), (35, 54.0000000000000), (36, 54.0000000000000), (37, 54.0000000000000), (38, 54.0000000000000), (39, 54.0000000000000), (40, 54.0000000000000)]

#       bit_security: [(1, 49.0000000000000), (2, 49.0000000000000), (3, 49.0000000000000), (4, 49.0000000000000), (5, 49.0000000000000), (6, 49.0000000000000), (7, 49.0000000000000), (8, 49.0000000000000), (9, 49.0000000000000), (10, 49.0000000000000), (11, 49.0000000000000), (12, 49.0000000000000), (13, 49.0000000000000), (14, 49.0000000000000), (15, 49.0000000000000), (16, 49.0000000000000), (17, 49.0000000000000), (18, 49.0000000000000), (19, 49.0000000000000), (20, 49.0000000000000), (21, 49.0000000000000), (22, 49.0000000000000), (23, 49.0000000000000), (24, 49.0000000000000), (25, 49.0000000000000), (26, 49.0000000000000), (27, 49.0000000000000), (28, 49.0000000000000), (29, 49.0000000000000), (30, 49.0000000000000), (31, 49.0000000000000), (32, 49.0000000000000), (33, 49.0000000000000), (34, 49.0000000000000), (35, 49.0000000000000), (36, 49.0000000000000), (37, 49.0000000000000), (38, 49.0000000000000), (39, 49.0000000000000), (40, 49.0000000000000)]

#       hint_lwe: [(1, 24.9779395992097), (2, 25.9779395145233), (3, 26.9779393451505), (4, 27.9779390064049), (5, 28.9779383289139), (6, 29.9779369739329), (7, 30.9779342639748), (8, 31.9779288440738), (9, 32.9779180043329), (10, 33.9778963250955), (11, 34.9778529675979), (12, 35.9777662565115), (13, 36.9775928499722), (14, 37.9772460994095), (15, 38.9765528482077), (16, 39.9751673443781), (17, 40.9724003220805), (18, 41.9668821478341), (19, 42.9559087180328), (20, 43.9342091265051), (21, 44.8917652124481), (22, 45.8104492365536), (23, 46.6603967487121), (24, 47.4002932052086), (25, 47.9889276766956), (26, 48.4076465165529), (27, 48.6736327733183), (28, 48.8276071281138), (29, 48.9112301132549), (30, 48.9549324062930), (31, 48.9772902299361), (32, 48.9886004305132), (33, 48.9942889559604), (34, 48.9971416520189), (35, 48.9985701181197), (36, 48.9992848819121), (37, 48.9996423966471), (38, 48.9998211872436), (39, 48.9999105908515), (40, 48.9999552947331)]
    

    
    




    

